<div class="course-card bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 h-full flex flex-col">
  <div class="p-6 flex-grow">
    <!-- Header with title and provider -->
    <div class="flex justify-between items-start mb-4">
      <h3 class="text-xl font-bold text-gray-800 mb-2 line-clamp-2 hover:text-blue-600 transition-colors">
        <%= course.title || 'Untitled Course' %>
      </h3>
      <span class="bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full whitespace-nowrap ml-2">
        <%= course.site || course.provider || 'Unknown' %>
      </span>
    </div>

    <!-- Description -->
    <p class="text-gray-600 mb-4 line-clamp-3 text-sm">
      <%= course.description || 'No description available.' %>
    </p>

    <!-- Key Details Grid -->
    <div class="grid grid-cols-2 gap-3 mb-4">
      <% if (course.duration) { %>
      <div class="flex items-center text-sm text-gray-600">
        <i class="far fa-clock mr-2 text-blue-500"></i>
        <span class="truncate"><%= course.duration %></span>
      </div>
      <% } %>

      <% if (course.level) { %>
      <div class="flex items-center text-sm text-gray-600">
        <i class="fas fa-chart-line mr-2 text-green-500"></i>
        <span><%= course.level %></span>
      </div>
      <% } %>

      <% if (course.category) { %>
      <div class="flex items-center text-sm text-gray-600">
        <i class="fas fa-tag mr-2 text-purple-500"></i>
        <span class="truncate"><%= course.category %></span>
      </div>
      <% } %>

      <% if (course.language) { %>
      <div class="flex items-center text-sm text-gray-600">
        <i class="fas fa-language mr-2 text-red-500"></i>
        <span><%= course.language %></span>
      </div>
      <% } %>
    </div>

    <!-- Price and Viewers -->
    <div class="flex justify-between items-center mb-4 text-sm">
      <% if (course.price) { %>
      <span class="text-green-600 font-semibold">
        <i class="fas fa-tag mr-1"></i>
        <%= course.price.length > 30 ? course.price.substring(0, 30) + '...' : course.price %>
      </span>
      <% } %>

      <% if (course.viewers) { %>
      <span class="text-gray-500">
        <i class="fas fa-eye mr-1"></i>
        <%= course.viewers.toLocaleString() %> viewers
      </span>
      <% } %>
    </div>

    <!-- Skills (Collapsible) -->
    <% if (course.skills && course.skills.length > 0) { %>
    <div class="mb-4">
      <div class="flex items-center justify-between cursor-pointer" onclick="toggleSkills(this)">
        <h4 class="text-sm font-semibold text-gray-700">
          <i class="fas fa-tools mr-1 text-blue-500"></i>
          Skills Covered
        </h4>
        <i class="fas fa-chevron-down text-xs text-gray-500 transition-transform"></i>
      </div>
      <div class="skills-container hidden mt-2">
        <div class="flex flex-wrap gap-2">
          <% course.skills.slice(0, 6).forEach(function(skill) { %>
          <span class="bg-gray-100 text-gray-800 text-xs px-2.5 py-1 rounded-full">
            <%= skill %>
          </span>
          <% }); %>
          <% if (course.skills.length > 6) { %>
          <span class="text-xs text-gray-500">+<%= course.skills.length - 6 %> more</span>
          <% } %>
        </div>
      </div>
    </div>
    <% } %>

    <!-- Instructors -->
    <% if (course.instructors && course.instructors.length > 0) { %>
    <div class="mb-4">
      <h4 class="text-sm font-semibold text-gray-700 mb-2">
        <i class="fas fa-chalkboard-teacher mr-1 text-purple-500"></i>
        Instructors
      </h4>
      <p class="text-xs text-gray-600 line-clamp-2">
        <%= course.instructors.join(', ') %>
      </p>
    </div>
    <% } %>

    <!-- Prerequisites -->
    <% if (course.prerequisites) { %>
    <div class="mb-4">
      <h4 class="text-sm font-semibold text-gray-700 mb-1">
        <i class="fas fa-requirements mr-1 text-orange-500"></i>
        Prerequisites
      </h4>
      <p class="text-xs text-gray-600 line-clamp-2">
        <%= course.prerequisites %>
      </p>
    </div>
    <% } %>
  </div>

  <!-- Footer with CTA -->
  <div class="bg-gray-50 px-6 py-4 border-t border-gray-100">
    <div class="flex justify-between items-center">
      <% if (course.url) { %>
      <a href="<%= course.url %>" target="_blank" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors flex items-center">
        View Course
        <i class="fas fa-external-link-alt ml-2 text-xs"></i>
      </a>
      <% } %>

      <div class="flex items-center space-x-2">
        <% if (course.original_provider_id) { %>
        <span class="text-xs text-gray-500" title="Provider ID">
          ID: <%= course.original_provider_id.substring(0, 8) %>...
        </span>
        <% } %>
      </div>
    </div>
  </div>
</div>

<script>
  function toggleSkills(element) {
    const container = element.nextElementSibling;
    const icon = element.querySelector('.fa-chevron-down');
    container.classList.toggle('hidden');
    icon.classList.toggle('rotate-180');
  }
</script>